## 1、网络模型

### 1.1、OSI七层模型

1、物理层：提供传输信号功能，载体为物理设备（光纤、集线器、调制解调器等），协议有（IEEE802.2等）；
2、链路层：提供可靠的数据传输功能，使用链路地址（mac地址）来访问介质，协议有（802.11、HDLC、STP、ARP等）；
3、网络层：提供IP选址及路由选择功能，包括（网络寻径、流量控制、错误检查等），协议有（IP、ICMP、IGMP、RIP等）；
4、传输层：提供网络数据流传输功能，协议有（TCP、UDP等）；
5、会话层：提供建立、管理和终止表示层与实体之间的通信会话功能，协议有（TLS、SSL等）；
6、表示层：提供用于应用层数据的编码和转换功能，如数据压缩和加密；
7、应用层：提供为各种面向用户的应用软件接入网络服务的功能，协议有（HTTP、FTP、SMTP、POP3、SSH、TELNET等）；

### 1.2、TCP/IP四层模型

1、网络接口层：提供地址解析协议（ARP、RARP）等，对应链路层；
2、网间层：提供IP协议、RIP协议（路由信息协议）等，负责数据的包装、寻址及路由，对应网络层；
3、传输层：提供TCP协议、UDP协议等，对应传输层；
4、应用层：提供HTTP协议、FTP协议、Telent协议、SMTP协议等，对应应用层及表示层；

## 2、TCP/UDP

### 2.1、TCP协议

1、特点：可靠的、面向连接的字节流服务（全双工）；
2、结构：首部（20字节：源端口、目的端口、序号seq、确认号ack、标志位[ACK、SYN、FIN等]、窗口大小、检验和等）、数据；
3、三次握手：（SYN=1、seq=x） => （SYN=1、ACK=1、seq=y、ack=+1） => (ACK=1、seq=x+1、ack=y+1)；
4、四次挥手：（FIN=1、seq=u） => (ACK=1、seq=v、ack=u+1) => (FIN=1、ACK=1、seq=w、ack=u+1) => (ACK=1、seq=u+1、ack=w+1)；
5、拥塞控制：慢启动（开始时，拥塞窗口为1，可以按指数级递增）、拥塞避免（拥塞窗口到达限定值，线性加1）、快重传（发送方尽快进行重传，而不是等超时重传计时器超时再重传）、快恢复（丢失个别的报文时，不启动慢开始算法，而执行快恢复算法）；
6、流量控制：通过滑动窗口的大小改变来实现，由接收方（可动态调整）回给发送方，通过缓冲区提高效率；
7、可靠传输：数据分段（合理长度）、超时重发、确认响应、数据校验（包有问题则丢弃，等发送端超时重发）、重排序、丢弃重复数据、流量控制；

### 2.2、UDP协议

1、特点：不可靠、无连接、快；
2、面向数据包：没有TCP的分组开销；

### 2.3、TCP与UDP的区别

​				TCP								UDP
是否连接			连接								非连接
传输可靠			可靠								不可靠
传输内容			字节流（分割成组，接收端重组）		报文（没有分组开销）
拥塞/流量控制		提供								不提供
首部大小			20字节							8字节
一对多			一对一							一对一、一对多、多对一、多对多

### 2.4、TCP粘包

1、概念：默认情况下，tcp连接会启用延时传输算法（Nagle算法），在数据发送之前缓存他们，短时间内有多个数据会缓存到一起做一次发送，这样可以减少IO的消耗提升性能；
2、解决：多次发送之间留间隔、关闭Nagle算法、拆包/封包（包与包之间插入一些特征数据后进行分割）；
3、UDP会吗：TCP是面向流的协议，UDP是面向消息的协议，含有消息保护边界，不能一次提取任意字节的消息；